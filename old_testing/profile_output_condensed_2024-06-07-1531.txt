Time elapsed for all runs: 4863.906249499996 s
Wrote profile results to ppo_gridworld_test.py.prof
         2497778158 function calls (2490844856 primitive calls) in 4869.411 seconds

        1    0.000    0.000    2.504    2.504 ppo.py:1(<module>)
       90    0.101    0.001    0.948    0.011 ppo.py:114(sample)
     2880    0.022    0.000    0.817    0.000 ppo.py:140(<dictcomp>)
        9    0.000    0.000    0.000    0.000 ppo.py:144(reset)
        6    0.000    0.000    0.005    0.001 ppo.py:149(layer_init)
        1    0.000    0.000    0.000    0.000 ppo.py:164(Actor_Net)
        1    0.000    0.000    0.006    0.006 ppo.py:165(__init__)
    21312    0.713    0.000   14.553    0.001 ppo.py:188(forward)
        1    0.000    0.000    0.000    0.000 ppo.py:227(Critic_Net)
        1    0.000    0.000    0.001    0.001 ppo.py:228(__init__)
    21329    0.497    0.000    9.099    0.000 ppo.py:234(forward)
        1    0.000    0.000    0.000    0.000 ppo.py:242(Actor_Critic_net)
        1    0.000    0.000    0.007    0.007 ppo.py:243(__init__)
    21312    0.589    0.000   24.370    0.001 ppo.py:272(forward)
      114    0.001    0.000    0.356    0.003 ppo.py:28(discount_cumsum)
       17    0.000    0.000    0.014    0.001 ppo.py:284(get_value)
    18432    0.562    0.000   51.334    0.003 ppo.py:287(act)
     2880    0.096    0.000    6.635    0.002 ppo.py:317(logprob_ent_from_state_acton)
        1    0.000    0.000    0.000    0.000 ppo.py:348(PPO)
        1    0.000    0.000    0.511    0.511 ppo.py:349(__init__)
        9    1.526    0.170 4835.632  537.292 ppo.py:448(roll_out)
        2    0.000    0.000    0.000    0.000 ppo.py:45(combined_shape)
     2880    0.874    0.000    8.650    0.003 ppo.py:553(compute_loss)
        9    0.320    0.036   27.600    3.067 ppo.py:587(optimise)
        1    0.000    0.000    0.000    0.000 ppo.py:61(PPOBuffer)
        1    0.000    0.000    0.000    0.000 ppo.py:65(__init__)
        1    0.002    0.002 4863.394 4863.394 ppo.py:660(train)
    18432    0.200    0.000    0.200    0.000 ppo.py:79(push)
      114    0.006    0.000    0.367    0.003 ppo.py:89(GAE_cal)

        1    0.000    0.000    0.000    0.000 custom_parking_env.py:1(<module>)
      215    0.001    0.000    0.977    0.005 custom_parking_env.py:120(define_spaces)
    18539    0.294    0.000   71.424    0.004 custom_parking_env.py:130(_info)
      107    0.000    0.000    3.679    0.034 custom_parking_env.py:150(_reset)
      107    0.027    0.000    0.159    0.001 custom_parking_env.py:155(_create_road)
        1    0.000    0.000    0.000    0.000 custom_parking_env.py:21(GoalEnv)
      107    0.032    0.000    3.518    0.033 custom_parking_env.py:214(_create_vehicles)
    73942    1.524    0.000    1.869    0.000 custom_parking_env.py:268(compute_reward)
    18432    0.156    0.000   70.981    0.004 custom_parking_env.py:295(_reward)
    36864    0.103    0.000    0.774    0.000 custom_parking_env.py:299(<genexpr>)
    36864    0.017    0.000    0.017    0.000 custom_parking_env.py:307(<genexpr>)
    36971    0.110    0.000    1.281    0.000 custom_parking_env.py:312(_is_success)
    18432    0.145    0.000   70.527    0.004 custom_parking_env.py:319(_is_terminated)
    36864    0.098    0.000    0.841    0.000 custom_parking_env.py:325(<genexpr>)
    18432    0.032    0.000    0.032    0.000 custom_parking_env.py:333(_is_truncated)
    36991    0.069    0.000    0.146    0.000 custom_parking_env.py:338(_is_crashed)
    73982    0.028    0.000    0.028    0.000 custom_parking_env.py:341(<genexpr>)
        1    0.000    0.000    0.000    0.000 custom_parking_env.py:60(CustomParkingEnv)
        1    0.000    0.000    0.017    0.017 custom_parking_env.py:82(__init__)
        1    0.000    0.000    0.000    0.000 custom_parking_env.py:86(default_config)

        1    0.000    0.000    0.441    0.441 abstract.py:1(<module>)
        2    0.000    0.000    0.000    0.000 abstract.py:114(configure)
      107    0.000    0.000    0.000    0.000 abstract.py:119(update_metadata)
      215    0.005    0.000    0.970    0.005 abstract.py:128(define_spaces)
    18539    0.022    0.000    0.022    0.000 abstract.py:148(_rewards)
    18539    0.096    0.000    0.281    0.000 abstract.py:179(_info)
      107    0.002    0.000    5.504    0.051 abstract.py:199(reset)
        1    0.000    0.000    0.000    0.000 abstract.py:23(AbstractEnv)
    18432    0.305    0.000 4753.699    0.258 abstract.py:237(step)
    18432    0.571    0.000 4464.419    0.242 abstract.py:266(_simulate)
    36864    0.032    0.000    0.032    0.000 abstract.py:348(_automatic_rendering)
        1    0.000    0.000    0.017    0.017 abstract.py:43(__init__)
        1    0.000    0.000    0.000    0.000 abstract.py:461(MultiAgentWrapper)
   296409    0.220    0.000    0.220    0.000 abstract.py:76(vehicle)
        1    0.000    0.000    0.000    0.000 abstract.py:88(default_config)

        1    0.000    0.000    0.191    0.191 road.py:1(<module>)
        1    0.000    0.000    0.000    0.000 road.py:20(RoadNetwork)
      107    0.000    0.000    0.000    0.000 road.py:23(__init__)
     3852    0.005    0.000    0.006    0.000 road.py:26(add_lane)
      107    0.000    0.000    0.002    0.000 road.py:282(lanes_dict)
      107    0.002    0.000    0.002    0.000 road.py:283(<dictcomp>)
        1    0.000    0.000    0.000    0.000 road.py:391(Road)
      107    0.000    0.000    0.000    0.000 road.py:395(__init__)
  1998895    1.571    0.000    1.571    0.000 road.py:40(get_lane)
    55296    0.752    0.000    1.067    0.000 road.py:461(act)
    55296   35.760    0.001 4460.886    0.081 road.py:467(step)
  1995043  118.052    0.000 1426.026    0.001 road.py:54(get_closest_lane_index)

